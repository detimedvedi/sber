# СберИндекс Anomaly Detection Methodology

**Generated:** 2025-11-07 02:29:21

---

## 1. Overview

This document describes the methodology used to detect anomalies in СберИндекс and Росстат data.
The system employs multiple detection methods to identify statistical outliers, temporal anomalies,
geographic deviations, cross-source discrepancies, and logical inconsistencies.

### Objectives

- Identify municipalities with unusual patterns in СберИндекс indicators
- Compare СберИндекс data with official Росстат statistics
- Detect data quality issues and logical inconsistencies
- Prioritize anomalies by severity for further investigation

## 2. Data Sources

### 2.1 СберИндекс Data

- **Connection data** (connection.parquet): Municipal connectivity indicators
- **Consumption data** (consumption.parquet): Consumption patterns by category
- **Market access data** (market_access.parquet): Market accessibility indicators

### 2.2 Росстат Data

- **Population data** (2_bdmo_population.parquet): Population statistics by municipality
- **Migration data** (3_bdmo_migration.parquet): Migration flows and patterns
- **Salary data** (4_bdmo_salary.parquet): Average salary by industry and municipality

### 2.3 Municipal Dictionary

- **Municipal districts** (t_dict_municipal_districts.xlsx): Reference data for municipality names and identifiers

## 3. Detection Methods

### 3.1 Statistical Outlier Detection

Identifies values that deviate significantly from statistical norms using three complementary methods:

**Z-Score Method** (threshold: 5.0)
- Calculates how many standard deviations a value is from the mean
- Flags values with |z-score| > 5.0
- Best for normally distributed data

**IQR Method** (multiplier: 3.0)
- Uses Interquartile Range (IQR = Q3 - Q1)
- Flags values < Q1 - 3.0 × IQR or > Q3 + 3.0 × IQR
- Robust to non-normal distributions

**Percentile Method** (lower: 0.1%, upper: 99.9%)
- Flags values in bottom 0.1% or top 0.09999999999999432% of distribution
- Identifies extreme values regardless of distribution shape

### 3.2 Temporal Anomaly Detection

Detects unusual patterns over time:

**Sudden Spikes** (spike threshold: 200%, drop threshold: -80%)
- Identifies period-over-period changes exceeding thresholds
- Growth rate > 200% indicates sudden spike
- Growth rate < -80% indicates sudden drop

**Trend Reversals**
- Detects significant changes in trend direction
- Compares recent trend with historical trend

**High Volatility** (multiplier: 3.0)
- Calculates standard deviation of period-over-period changes
- Flags municipalities with volatility > 3.0 × median volatility

### 3.3 Geographic Anomaly Detection

Identifies municipalities that differ from their geographic context:

**Regional Outliers** (threshold: 6.0 std dev)
- Calculates z-scores within each region/oblast
- Flags municipalities > 6.0 standard deviations from regional mean

**Cluster Outliers** (threshold: 5.0 std dev)
- Groups similar municipalities into clusters
- Identifies municipalities that differ significantly from their cluster

**Urban vs Rural Analysis**
- Separate analysis for urban and rural municipalities
- Accounts for structural differences between municipality types

### 3.4 Cross-Source Comparison

Compares СберИндекс data with Росстат official statistics:

**Correlation Analysis** (threshold: 0.5)
- Calculates correlation coefficients between comparable indicators
- Flags indicator pairs with correlation < 0.5
- Low correlation may indicate data quality issues

**Discrepancy Detection** (threshold: 50%)
- Calculates percentage difference between СберИндекс and Росстат values
- Flags municipalities with differences > 50%
- Ranks municipalities by magnitude of discrepancy

### 3.5 Logical Consistency Checks

Validates data for logical consistency:

**Negative Value Detection**
- Identifies negative values where only positive values are logically possible
- Examples: population, consumption amounts, salary

**Contradictory Indicators**
- Identifies conflicting metrics
- Examples: high consumption with low connection rates

## 4. Severity Scoring

Each anomaly is assigned a severity score from 0 to 100 based on:

- **Deviation magnitude**: How far the value deviates from expected
- **Statistical significance**: Z-score or other statistical measures
- **Impact potential**: Importance of the affected indicator

### Severity Categories

| Score Range | Category | Interpretation |
|-------------|----------|----------------|
| 0-25 | Low | Minor deviation, may be normal variation |
| 25-50 | Medium | Notable deviation, worth investigating |
| 50-75 | High | Significant deviation, likely requires attention |
| 75-100 | Critical | Extreme deviation, requires immediate investigation |

## 5. Interpretation Guidelines

### 5.1 Understanding Anomalies

An anomaly does not necessarily indicate an error. It may represent:

- **Data quality issues**: Missing data, measurement errors, reporting problems
- **Genuine unusual patterns**: Real events or conditions that differ from the norm
- **Structural differences**: Unique characteristics of specific municipalities
- **Temporal events**: Seasonal effects, one-time events, policy changes

### 5.2 Investigation Steps

When investigating an anomaly:

1. **Verify the data**: Check source data for accuracy and completeness
2. **Consider context**: Look for explanations in local conditions or events
3. **Compare indicators**: Check if multiple indicators show similar patterns
4. **Review temporal trends**: Examine historical data for patterns
5. **Geographic comparison**: Compare with neighboring municipalities
6. **Consult domain experts**: Seek input from local specialists

### 5.3 False Positives

Some anomalies may be false positives due to:

- **Small sample sizes**: Limited data leading to statistical artifacts
- **Legitimate outliers**: Genuinely unique municipalities
- **Measurement differences**: Different methodologies between data sources
- **Timing differences**: Data collected at different times

## 6. Configuration Summary

### Detection Thresholds

```yaml
thresholds:
  statistical:
    z_score: 5.0
    iqr_multiplier: 3.0
    percentile_lower: 0.1
    percentile_upper: 99.9
  temporal:
    spike_threshold: 200
    drop_threshold: -80
    volatility_multiplier: 3.0
  geographic:
    regional_z_score: 6.0
    cluster_threshold: 5.0
  cross_source:
    correlation_threshold: 0.5
    discrepancy_threshold: 50
```

---

*This methodology document was automatically generated by the СберИндекс Anomaly Detection System.*